{{>header}}
<div class="home_content">
    <div class="slider">
        <div id="carouselExampleControls" class="carousel slide" data-ride="carousel" data-interval="10000">
            <div class="carousel-inner">
                <div class="carousel-item active ">
                    <img class="d-block w-100" src="/image/web/slider1.jpg" alt="First slide">
                    <div class="carousel-caption d-none d-md-block">
                        <h3>Let's go now</h3>
                        <h1>Explore and Travel</h1>
                        <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor.
                            Aenean massa. Cum sociis Theme</p>
                    </div>s
                </div>
                <div class="carousel-item ">
                    <img class="d-block w-100" src="/image/web/slider2.jpg" alt="Second slide">
                    <div class="carousel-caption d-none d-md-block">
                        <h3>Come with us</h3>
                        <h1>Relax and Enjoy.</h1>
                        <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor.
                            Aenean massa. Cum sociis Theme</p>
                    </div>
                </div>

            </div>
            <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>
        <div class="find">

            <form action="/tours">
                <input class="" id="search" type="text" list="origin-options1"
                    placeholder="Search by destination or tour name" aria-describedby="origin-label" oninput='onInput()'
                    name="search">
                <datalist id="origin-options1"></datalist>
                <div class="drop">
                    <span class="" type="button" id="dropdownMenuButton1" aria-expanded="false">
                        Month
                    </span>
                    <ul class="menu" aria-labelledby="dropdownMenuButton1">
                        <li><a class="dropdown-item" href="#">January</a></li>
                        <li><a class="dropdown-item" href="#">February </a></li>
                        <li><a class="dropdown-item" href="#">March</a></li>
                        <li><a class="dropdown-item" href="#">April</a></li>
                        <li><a class="dropdown-item" href="#">May </a></li>
                        <li><a class="dropdown-item" href="#">June</a></li>
                        <li><a class="dropdown-item" href="#">July</a></li>
                        <li><a class="dropdown-item" href="#">August </a></li>
                        <li><a class="dropdown-item" href="#">September</a></li>
                        <li><a class="dropdown-item" href="#">October</a></li>
                        <li><a class="dropdown-item" href="#">November </a></li>
                        <li><a class="dropdown-item" href="#">December</a></li>
                    </ul>
                    <input type="number" class="dropValue" style="display: none;" name="month">
                </div>
                <div class="drop">
                    <span class="" type="button" id="dropdownMenuButton2" aria-expanded="false">
                        Travel type
                    </span>
                    <ul class="menu" aria-labelledby="dropdownMenuButton2" style="height: auto;">
                        {{!-- <li><a class="dropdown-item" href="#">Travel Type</a></li> --}}
                        {{#each category}}
                        <li><a class="dropdown-item" data-id={{this.id}}>{{this.name}}</a></li>
                        {{/each}}
                        <input type="number" class="dropValue" style="display: none;" name="category">

                    </ul>
                </div>
                <button>Find now</button>
            </form>
        </div>
    </div>

    <div class="tour-content">
        <div class="head">
            <h3>Choose Your</h3>
            <h1>Perfect Holiday</h1>
            <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aene an commodo ligula eget dolor. Aenean
                massa. Cum sociis the</p>
        </div>
        <div class="content">

            {{#each hotNewTours}}
            <a class="tour-info tourDetail" data-star="{{rate this.totalRate}}" href="/tours/{{this.tour_id}}">
                <span class="badge badge-pill badge-danger hot_new">{{hotnew this.tour_is_hot}}</span>
                <img src="/file/tours/{{this.image.[0]}}">
                <div class="detail">
                    <div>
                        <h5 class="city-name">{{this.tour_name}}</h5>
                        {{!-- <p class="rate">{{rate this.totalRate}}</p> --}}
                        <div class="rating1">

                            <i class="far fa-star"></i>
                            <i class="far fa-star"></i>
                            <i class="far fa-star"></i>
                            <i class="far fa-star"></i>
                            <i class="far fa-star"></i>
                        </div>
                    </div>
                    <h5 class="money">${{this.tour_price}}</h5>
                </div>
            </a>
            {{/each}}


        </div>
    </div>
    <div class="destination">
        <div class="head">
            <h3>Choose your</h3>
            <h1>Destination</h1>
            <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aene an commodo ligula eget dolor. Aenean
                massa. Cum sociis</p>
        </div>
        <button type="button" class="btn btn-info" style="float:right;margin-right: 30px;">All</button>
        <div class="swiper mySwiper">
            <div class="swiper-wrapper">
                {{#each des}}
                <div class="swiper-slide">
                    <a href="/destinations/{{this.id}}">
                        <img src="/file/destinations/{{this.image.[0]}}" /> </a>
                    <div>
                        <h5>{{this.name}}</h5>
                        {{!-- <p>xxxxxxx</p> --}}
                    </div>

                </div>
                {{/each}}
            </div>
            <div class="swiper-pagination"></div>
        </div>

    </div>

    <div class="video">
        <div class="video-content">

            <div class="head">
                <h3>Go & Discover</h3>
                <h1>Breathtaking Cities</h1>
                <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor.
                    Aenean massa. Cum sociis Theme</p>
            </div>
            {{!-- <a href="https://vimeo.com/71319358"></a> --}}
            <div class=" video embed-responsive embed-responsive-16by9">
                {{!-- <iframe class="embed-responsive-item" src="https://vimeo.com/video/232119361"
                    allowfullscreen></iframe> --}}
                <iframe src="https://player.vimeo.com/video/232119361?h=f8111fafe6" width="640" height="360"
                    frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>
                <p><a href="https://vimeo.com/232119361">Why Travel?</a> from <a
                        href="https://vimeo.com/user70666729">Kimball Palmer</a> on <a
                        href="https://vimeo.com">Vimeo</a>.</p>
            </div>
        </div>
        <div class="video-footer row">
            <div class="item col">
                <img src="	https://setsail.qodeinteractive.com/wp-content/uploads/2018/09/h1-custom-icon-img-1.png">
                <h5>Restaurants</h5>
                <p>Aenean commodo ligula eget dolor. Lorem ipsum</p>
            </div>
            <div class="item col">
                <img src="	https://setsail.qodeinteractive.com/wp-content/uploads/2018/09/h1-custom-icon-img-2.png">
                <h5>Sightseeing</h5>
                <p>Aenean commodo ligula eget dolor. Lorem ipsum</p>
            </div>
            <div class="item col">
                <img src="	https://setsail.qodeinteractive.com/wp-content/uploads/2018/09/h1-custom-icon-img-3.png">
                <h5>Shops & Boutiques</h5>
                <p>Aenean commodo ligula eget dolor. Lorem ipsum</p>
            </div>
            <div class="item col">
                <img src="	https://setsail.qodeinteractive.com/wp-content/uploads/2018/09/h1-custom-icon-img-4.png">
                <h5>Where to Stay</h5>
                <p>Aenean commodo ligula eget dolor. Lorem ipsum</p>
            </div>
        </div>
    </div>
    <div class="plan-holiday">
        <div class="head">
            <h3>Plan the</h3>
            <h1>Perfect Holiday</h1>
            <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aene an commodo ligula eget dolor. Aenean
                massa. Cum sociis</p>
        </div>
        <button type="button" class="btn btn-info" style="float:right;margin-right: 30px;">All</button>
        <div class="swiper mySwiper2">
            <div class="swiper-wrapper">
                {{#each this.tours}}
                <div class="swiper-slide"><a href="/tours/{{this.id}}">
                        <img src="/file/tours/{{this.image.[0]}}"> </a>
                    <div>
                        <h4>{{this.name}}</h4>
                        <p>{{this.description}}</p>
                        <p>${{this.price}}</p>
                    </div>

                </div>
                {{/each}}
            </div>
            <div class="swiper-button-next" style="right: 0px;"></div>
            <div class="swiper-button-prev" style="left: 0px;"></div>
            <div class="swiper-pagination"></div>
        </div>

    </div>

</div>
{{>footer}}
<script src="https://unpkg.com/swiper@7/swiper-bundle.min.js"></script>
<script>
    let tours = document.querySelectorAll('.tourDetail'); let star = document.querySelectorAll('.rating1 .fa-star');
    for (var i = 0; i < tours.length; i++) {
        let rate = Number(tours[i].dataset.star);
        console.log(11111, rate)
        for (var j = 5 * i; j < 5 * i + rate; j++) {
            star[j].classList.add('star-active')
        }
    }

    var swiper = new Swiper(".mySwiper", {
        effect: "coverflow",
        grabCursor: true,
        centeredSlides: true,
        slidesPerView: "auto",
        coverflowEffect: {
            rotate: 50,
            stretch: 0,
            depth: 100,
            modifier: 1,
            slideShadows: true,
        },
        autoplay: {
            delay: 2500,
            disableOnInteraction: false,
        },
        loop: true,
        pagination: {
            el: ".swiper-pagination",
        },
    });
    var swiper = new Swiper(".mySwiper2", {
        slidesPerView: 5,
        centeredSlides: true,
        spaceBetween: 30,
        pagination: {
            el: ".swiper-pagination",
            clickable: true,
        }, loop: true,
        navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",
        }
    });
    $(document).ready(function () {
        $('.carousel').carousel({
            interval: 2000
        })
    });
    function getNumericMonth(monthAbbr) {
        return (String(['January',
            'February',
            'March',
            'April',
            'May',
            'June',
            'July',
            'August',
            'September',
            'October',
            'November',
            'December'].indexOf(monthAbbr) + 1).padStart(2, '0')
        );
    } let inputValue = document.querySelectorAll('.dropValue');
    let li = document.querySelectorAll('.drop .menu li');
    for (var i = 0; i < li.length; i++) {

        (function (index) {

            li[i].addEventListener('click', function (e) {

                if (index < 11) inputValue[0].value = getNumericMonth(e.target.innerText);
                else inputValue[1].value = e.target.dataset.id;

            })
        })(i);
    }
    var drop = document.querySelectorAll('.home_content .drop')
    var dropshow = document.querySelectorAll('.home_content .drop span');
    var menu = document.querySelectorAll('.home_content .drop .menu');


    document.onclick = function (e) {
        for (var i = 0; i < menu.length; i++) {
            if (e.target != menu[i] && e.target != dropshow[i])
                menu[i].classList.remove('shows')
        }
    }
    dropshow.forEach(function (t, i) {
        t.addEventListener('click', function (e) {
            active(e, i);
        })
    });
    function active(e, i) {
        menu[i].classList.toggle('shows')
    };



    var list1 = drop[0].querySelectorAll('li');
    var list2 = drop[1].querySelectorAll('li');
    list1.forEach(function (l, i) {
        var t = 0;
        var x = list1[i].innerText;
        l.onclick = function (e) {
            displayList(e, x, t);
        }
    });
    list2.forEach(function (l, i) {
        var t = 1;
        var x = list2[i].innerText;
        l.onclick = function (e) {
            displayList(e, x, t);
        }
    });
    function displayList(e, x, t) {
        dropshow[t].innerText = x;
    }
    function onInput() {
        var val = document.getElementById("search").value;
        var opts = document.getElementById('origin-options1').childNodes;

        for (var i = 0; i < opts.length; i++) {
            if (opts[i].value === val) {
                let url
                if (opts[i].dataset.type == "tour")
                    url = `/tours/${opts[i].dataset.id}`;
                else url = `/destinations/${opts[i].dataset.id}`;
                window.location.replace(url);

            }
        }
    }
    var input = document.getElementById('search');
    var datalist = document.getElementById('origin-options1');
    input.onkeyup = async function (e) {
        let data = e.target.value;

        const params = new URLSearchParams({ keyword: input.value });
        const response = await fetch(`/find?keyword=${input.value}`);
        const dataReturn = await response.json(); datalist.textContent = "";

        dataReturn.forEach((entry) => {

            if (entry.type === 'tour') {
                datalist.insertAdjacentHTML(
                    "beforeend",
                    `<option class="optionSearchTour" data-type="tour"  data-id=${entry.id} value="Tour: ${entry.name}"></option>`
                );
            } else {
                datalist.insertAdjacentHTML(
                    "beforeend",
                    `<option class="optionSearchDes" data-type="des" data-id=${entry.id} value="Destination: ${entry.name}"></option>`
                );
            }

        });




        let options = document.querySelectorAll('.optionSearch');
        for (var i = 0; i < options.length; i++) {
            options[i].onclick = function (e) {
                //destination or tour detail
            }
        }
    }

</script>